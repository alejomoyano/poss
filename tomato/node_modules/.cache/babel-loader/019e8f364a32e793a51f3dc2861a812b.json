{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { getApp } from \"firebase/app\";\nimport { getFirestore, collection, onSnapshot, deleteField, updateDoc, doc, setDoc, getDoc, arrayUnion, arrayRemove } from \"firebase/firestore\";\nconst initialState = {\n  value: {},\n  error: null\n};\nconst createChat = createAsyncThunk(\"createChat\", async (id, thunkAPI) => {\n  try {\n    //TODO -> creamos la taskboard con el mismo id que la room\n    return thunkAPI.fulfillWithValue({\n      chat: chat\n    });\n  } catch (error) {\n    return thunkAPI.rejectWithValue({\n      error\n    });\n  }\n});\nexport const messagesSlice = createSlice({\n  name: 'mensajes',\n  initialState,\n  reducers: {\n    setMessages: (state, action) => {\n      state.mensajes = action.payload.mensajes;\n    }\n  }\n});\nconst {\n  setMensajes\n} = messagesSlice.actions;\n\nconst addMessage = async message => {\n  try {\n    const app = getApp();\n    const db = getFirestore(app);\n    const chat = doc(db, \"chat/1\");\n    console.log(chat);\n    await updateDoc(chat, {\n      mensajes: arrayUnion(message)\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nexport const {\n  setMenssages\n} = messagesSlice.actions;\nexport { addMessage };\nexport default messagesSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","getApp","getFirestore","collection","onSnapshot","deleteField","updateDoc","doc","setDoc","getDoc","arrayUnion","arrayRemove","initialState","value","error","createChat","id","thunkAPI","fulfillWithValue","chat","rejectWithValue","messagesSlice","name","reducers","setMessages","state","action","mensajes","payload","setMensajes","actions","addMessage","message","app","db","console","log","setMenssages","reducer"],"sources":["C:/Users/Usuario/Documents/GitHub/poss/tomato/src/redux/slices/ChatSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport { getApp } from \"firebase/app\";\r\nimport {\r\n    getFirestore,\r\n    collection,\r\n    onSnapshot,\r\n    deleteField,\r\n    updateDoc,\r\n    doc,\r\n    setDoc,\r\n    getDoc,\r\n    arrayUnion,\r\n    arrayRemove,\r\n  } from \"firebase/firestore\";\r\n\r\n\r\n  const initialState = {\r\n    value: {},\r\n    error: null,\r\n  };\r\n\r\n  const createChat = createAsyncThunk(\r\n    \"createChat\",\r\n    async (id, thunkAPI) => {\r\n      try {\r\n        //TODO -> creamos la taskboard con el mismo id que la room\r\n        return thunkAPI.fulfillWithValue({ chat: chat });\r\n      } catch (error) {\r\n        return thunkAPI.rejectWithValue({ error });\r\n      }\r\n    }\r\n  );\r\n\r\n  export const messagesSlice = createSlice({\r\n    name: 'mensajes',\r\n    initialState,\r\n    reducers: {\r\n        setMessages: (state, action) => {\r\n            state.mensajes = action.payload.mensajes\r\n        } \r\n    }\r\n\r\n\r\n  })\r\n\r\n  const { setMensajes } = messagesSlice.actions\r\n\r\n  const addMessage = async (message) => {\r\n       try {\r\n        const app = getApp();\r\n        const db = getFirestore(app);\r\n        const chat = doc(db, \"chat/1\");\r\n        console.log(chat);\r\n\r\n         await updateDoc(chat, {\r\n           mensajes: arrayUnion(message),\r\n         });\r\n       } catch (error) {\r\n         console.log(error);\r\n       }\r\n     };\r\n\r\n  \r\n\r\n\r\n  export const {setMenssages} = messagesSlice.actions\r\n\r\n  export{\r\n    addMessage\r\n  } \r\n  \r\n\r\n  export default messagesSlice.reducer"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,gBAAtB,QAA8C,kBAA9C;AACA,SAASC,MAAT,QAAuB,cAAvB;AACA,SACIC,YADJ,EAEIC,UAFJ,EAGIC,UAHJ,EAIIC,WAJJ,EAKIC,SALJ,EAMIC,GANJ,EAOIC,MAPJ,EAQIC,MARJ,EASIC,UATJ,EAUIC,WAVJ,QAWS,oBAXT;AAcE,MAAMC,YAAY,GAAG;EACnBC,KAAK,EAAE,EADY;EAEnBC,KAAK,EAAE;AAFY,CAArB;AAKA,MAAMC,UAAU,GAAGf,gBAAgB,CACjC,YADiC,EAEjC,OAAOgB,EAAP,EAAWC,QAAX,KAAwB;EACtB,IAAI;IACF;IACA,OAAOA,QAAQ,CAACC,gBAAT,CAA0B;MAAEC,IAAI,EAAEA;IAAR,CAA1B,CAAP;EACD,CAHD,CAGE,OAAOL,KAAP,EAAc;IACd,OAAOG,QAAQ,CAACG,eAAT,CAAyB;MAAEN;IAAF,CAAzB,CAAP;EACD;AACF,CATgC,CAAnC;AAYA,OAAO,MAAMO,aAAa,GAAGtB,WAAW,CAAC;EACvCuB,IAAI,EAAE,UADiC;EAEvCV,YAFuC;EAGvCW,QAAQ,EAAE;IACNC,WAAW,EAAE,CAACC,KAAD,EAAQC,MAAR,KAAmB;MAC5BD,KAAK,CAACE,QAAN,GAAiBD,MAAM,CAACE,OAAP,CAAeD,QAAhC;IACH;EAHK;AAH6B,CAAD,CAAjC;AAYP,MAAM;EAAEE;AAAF,IAAkBR,aAAa,CAACS,OAAtC;;AAEA,MAAMC,UAAU,GAAG,MAAOC,OAAP,IAAmB;EACjC,IAAI;IACH,MAAMC,GAAG,GAAGhC,MAAM,EAAlB;IACA,MAAMiC,EAAE,GAAGhC,YAAY,CAAC+B,GAAD,CAAvB;IACA,MAAMd,IAAI,GAAGZ,GAAG,CAAC2B,EAAD,EAAK,QAAL,CAAhB;IACAC,OAAO,CAACC,GAAR,CAAYjB,IAAZ;IAEC,MAAMb,SAAS,CAACa,IAAD,EAAO;MACpBQ,QAAQ,EAAEjB,UAAU,CAACsB,OAAD;IADA,CAAP,CAAf;EAGD,CATD,CASE,OAAOlB,KAAP,EAAc;IACdqB,OAAO,CAACC,GAAR,CAAYtB,KAAZ;EACD;AACF,CAbJ;;AAkBA,OAAO,MAAM;EAACuB;AAAD,IAAiBhB,aAAa,CAACS,OAArC;AAEP,SACEC,UADF;AAKA,eAAeV,aAAa,CAACiB,OAA7B"},"metadata":{},"sourceType":"module"}